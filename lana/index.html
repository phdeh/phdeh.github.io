<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="js/utils.js"></script>
    <script src="js/lexems.js"></script>
    <script src="js/lexer.js"></script>
    <script src="js/parser.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery.min.js">\x3C/script>')</script>
    <script>

        function onload() {
            $("#enablejs").hide();
            $("#code").show();
            $("#handlebutton").show();
            $("#logbutton").show();
            $("#result").show();

            var url = window.location.href;
            var params = parseURLParams(url);
            try {
                var calc = params['c'];
                if (calc != null)
                    $("#code").val(calc);
            } catch (e) {

            }
        }

        function handle() {
            try {
                var code = $("#code").val();
                var tokenized = tokenize(code);
                var parsed = parse(tokenized);
                var rendered = render(parsed);
                var calculated = render(calculate(parsed));
                $("#result").html(rendered + " = " + calculated);
            } catch (e) {
                $("#result").html("Что-то пошло не так.");
            }
            $("#log").html(lexerlog + '<hr/><br/>' + lexerresult + '<hr/><br/>' + parserlog);
            window.history.pushState('', '', "?c=" + encodeURIComponent(code));
        }
    </script>
    <link href="css/style.css" rel="stylesheet"/>
    <title>Lana Interprier</title>
</head>
<body onload="onload();handle()">
<h2>Lana Interprier</h2>
<div class="result" id="enablejs">Этот сайт использует JavaScript и производит все расчёты на стороне клиента. Пожалуйста, включите JavaScript, чтобы
получить какой-то результат.</div>
<textarea class="log" id="code" hidden>
x * 5
</textarea>

<div class="button_container">
    <div class="button" id="handlebutton" onclick="handle()" hidden>Обработать</div>
    <div class="button" id="logbutton" onclick="$('#log').show(); $('#logbutton').hide()" hidden>Показать лог</div>
</div>

<div class="result" id="result" hidden>
    Что-то пошло не так.
</div>
<div class="log" id="log" style="white-space: pre-wrap" hidden>

</div>
<div class="footer">
    копирует &copy; Воробьев 2018, все средства производства обобщены
</div>
</body>
</html>